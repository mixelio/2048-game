(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&e(d)}).observe(document,{childList:!0,subtree:!0});function l(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(t){if(t.ep)return;t.ep=!0;const i=l(t);fetch(t.href,i)}})();const g=document.querySelector(".start"),s=document.querySelectorAll(".field-row"),L=document.querySelector(".game-score"),o=document.querySelectorAll(".message");let a=Math.floor(Math.random()*4),h=Math.floor(Math.random()*4);const m=4;let f=0,u=0;const n=[["","","",""],["","","",""],["","","",""],["","","",""]];g.addEventListener("click",c=>{for(let r=0;r<n.length;r++)for(let l=0;l<n[r].length;l++)n[r][l]="",s[r].children[l].className="",s[r].children[l].classList.add("field-cell"),g.textContent="Restart";for(g.classList.add("restart"),n[Math.floor(Math.random()*4)][Math.floor(Math.random()*4)]=2;n[a][h]!=="";)a=Math.floor(Math.random()*4),h=Math.floor(Math.random()*4);n[Math.floor(Math.random()*4)][Math.floor(Math.random()*4)]=2;for(let r=0;r<n.length;r++)for(let l=0;l<n[r].length;l++)s[r].children[l].textContent=n[r][l],n[r][l]!==""&&s[r].children[l].classList.add(`field-cell--${n[r][l]}`);for(let r=0;r<o.length;r++)o[r].classList.contains("message-start")&&o[r].classList.add("hidden"),o[r].classList.contains("message-lose")&&o[r].classList.add("hidden")});document.addEventListener("keydown",c=>{if(c.key==="ArrowRight"){n.forEach((r,l)=>{const e=r.map(t=>t===""?0:t);e.sort((t,i)=>t===0&&i!==0?(f++,-1):t!==0&&i===0?1:0);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&e[t]!==0&&(e[t]+=e[t-1],u+=e[t],e[t-1]=0,f++,s[l].children[t].textContent=e[t]),e[t]===0&&(e[t]=e[t-1],e[t-1]=0);for(let t=0;t<r.length;t++)e[t]===0?(r[t]="",s[l].children[t].textContent=r[t]):r[t]=e[t]});for(let r=0;r<n.length;r++)for(let l=0;l<n[r].length;l++)s[r].children[l].textContent=n[r][l],s[r].children[l].className="",s[r].children[l].classList.add("field-cell"),n[r][l]!==""&&s[r].children[l].classList.add(`field-cell--${n[r][l]}`)}if(c.key==="ArrowLeft"){n.forEach((r,l,e)=>{const t=r.map(i=>i===""?0:i);t.sort((i,d)=>d===0&&i!==0?(f++,-1):d!==0&&i===0?1:0);for(let i=0;i<t.length-1;i++)t[i]===t[i+1]&&t[i]!==0&&(t[i]+=t[i+1],u+=t[i],t[i+1]=0,f++,s[l].children[i].textContent=t[i]),t[i]===0&&(t[i]=t[i+1],t[i+1]=0);for(let i=0;i<r.length;i++)t[i]===0?(r[i]="",s[l].children[i].textContent=r[i]):r[i]=t[i]});for(let r=0;r<n.length;r++)for(let l=0;l<n[r].length;l++)s[r].children[l].textContent=n[r][l],s[r].children[l].className="",s[r].children[l].classList.add("field-cell"),n[r][l]!==""&&s[r].children[l].classList.add(`field-cell--${n[r][l]}`)}if(c.key==="ArrowDown"){n.forEach(r=>{for(let l=0;l<r.length;l++)r[l]===""&&(r[l]=0)});for(let r=0;r<m;r++){const l=[];for(let e=0;e<n.length;e++)l.push(n[e][r]);l.sort((e,t)=>e===0&&t!==0?(f++,-1):e!==0&&t===0?1:0);for(let e=l.length-1;e>0;e--)l[e]===l[e-1]&&l[e]!==0&&(l[e]+=l[e],u+=l[e],l[e-1]=0,f++,l.sort((t,i)=>t===0&&i!==0?-1:t!==0&&i===0?1:0));for(let e=0;e<n.length;e++)l[e]===0?n[e][r]="":n[e][r]=l[e];for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)s[e].children[t].textContent=n[e][t],s[e].children[t].className="",s[e].children[t].classList.add("field-cell"),n[e][t]!==""&&s[e].children[t].classList.add(`field-cell--${n[e][t]}`)}}if(c.key==="ArrowUp"){n.forEach(r=>{for(let l=0;l<r.length;l++)r[l]===""&&(r[l]=0)});for(let r=0;r<m;r++){const l=[];for(let e=0;e<n.length;e++)l.push(n[e][r]);l.sort((e,t)=>t===0&&e!==0?(f++,-1):t!==0&&e===0?1:0);for(let e=l.length-1;e>0;e--)l[e]===l[e-1]&&l[e]!==0&&(l[e]+=l[e],u+=l[e],l[e-1]=0,f++,l.sort((t,i)=>i===0&&t!==0?-1:i!==0&&t===0?1:0));for(let e=0;e<n.length;e++)l[e]===0?n[e][r]="":n[e][r]=l[e];for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)s[e].children[t].textContent=n[e][t],s[e].children[t].className="",s[e].children[t].classList.add("field-cell"),n[e][t]!==""&&s[e].children[t].classList.add(`field-cell--${n[e][t]}`)}}if(f===0){let r=!1;for(let l=0;l<n.length;l++)n[l].includes("")&&(r=!0);if(!r){let l=!1;for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length-1;t++)n[e][t]===n[e][t+1]&&(l=!0);for(let e=0;e<n.length-1;e++)for(let t=0;t<n[e].length;t++)n[e][t]===n[e+1][t]&&(l=!0);if(!l)for(let e=0;e<o.length;e++)o[e].classList.contains("message-win")&&o[e].classList.add("hidden"),o[e].classList.contains("message-lose")&&o[e].classList.remove("hidden")}}if(f>0){for(;n[a][h]!=="";)a=Math.floor(Math.random()*4),h=Math.floor(Math.random()*4);if(n[a][h]=Math.random()>.9?4:2,f=0,f===0){let r=!1;for(let l=0;l<n.length;l++)n[l].includes("")&&(r=!0);if(!r){let l=!1;for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length-1;t++)n[e][t]===n[e][t+1]&&(l=!0);for(let e=0;e<n.length-1;e++)for(let t=0;t<n[e].length;t++)n[e][t]===n[e+1][t]&&(l=!0);if(!l)for(let e=0;e<o.length;e++)o[e].classList.contains("message-win")&&o[e].classList.add("hidden"),o[e].classList.contains("message-lose")&&o[e].classList.remove("hidden")}}}L.textContent=u;for(let r=0;r<n.length;r++)for(let l=0;l<n[r].length;l++){if(s[r].children[l].textContent=n[r][l],n[r][l]===2048)for(let e=0;e<o.length;e++)o[e].classList.contains("message-win")&&o[e].classList.remove("hidden");n[r][l]!==""?s[r].children[l].classList.add(`field-cell--${n[r][l]}`):(s[r].children[l].className="",s[r].children[l].classList.add("field-cell"))}a=Math.floor(Math.random()*4),h=Math.floor(Math.random()*4)});
